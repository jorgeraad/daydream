# 20260212114213 - AI Dialogue

| Field              | Value |
|--------------------|-------|
| **Created**        | 2026-02-12 11:42:20 EST |
| **Last Modified**  | 2026-02-12 11:42:20 EST |
| **Status**         | todo |
| **Branch**         | — |
| **Agent**          | — |
| **Blocked-By**     | 20260212114209, 20260212114211, 20260212114212 |
| **Touches**        | packages/renderer/src/ui/DialoguePanel.ts, apps/game/src/ |
| **References**     | [Design Doc](../../docs/design.md), [PRD](../../docs/prd.md) |

## Description

Wire together the AI client, character interaction, and narrative bar into the full dialogue system. Build the DialoguePanel UI. Implement the conversation flow: character speaks (streamed typewriter) → player picks from AI-generated options or types freeform → character responds. Track conversation state across turns.

## Acceptance Criteria

- [ ] DialogueManager orchestrates the full conversation flow
- [ ] DialoguePanel renders in the narrative bar (character name + speech text)
- [ ] Text streams character-by-character (typewriter effect) via AI client streaming
- [ ] 2-4 AI-generated response options displayed as a numbered selectable list
- [ ] Options include dialogue and action types with varied tones
- [ ] Freeform text input option (`>` prompt) works
- [ ] Conversation state tracked (turns, topics discussed, mood)
- [ ] Pressing Escape exits dialogue and returns to exploration mode
- [ ] Dialogue mode key bindings (number keys, arrow keys, Enter, Escape)
- [ ] Unit tests for DialogueManager conversation state management
- [ ] Unit tests for dialogue mode input handling
- [ ] Integration test with mocked AI responses for full dialogue flow
- [ ] Visual smoke test: have a real conversation with a test character

## Implementation Steps

_To be filled in when the task is started._

## Progress Log

### 2026-02-12 11:42:20 EST
Initial creation. Extracted from design doc Sections 7 (Dialogue System) and Section 16 Step 5. This is the convergence point of the AI client, TUI layout, and character interaction tracks.
